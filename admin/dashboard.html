""  
<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Admin - Otjiningirua West</title>
	<style>
		body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, sans-serif; margin: 20px; }
		.container { max-width: 900px; margin: 0 auto; }
		.card { border: 1px solid #ddd; border-radius: 8px; padding: 16px; margin-bottom: 16px; }
		input, textarea, select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 6px; margin: 8px 0; }
		button { background: #2c5530; color: #fff; border: 0; padding: 10px 16px; border-radius: 6px; cursor: pointer; }
		button:disabled { background: #9bb29e; }
		.grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 12px; }
		pre { white-space: pre-wrap; background: #f6f8fa; padding: 10px; border-radius: 6px; }
	</style>
</head>
<body>
	<div class="container">
		<h1>Admin Dashboard</h1>
		<p>Add rams and beans, and upload videos. Data is stored locally.</p>

		<div class="card">
			<h2>Add Ram</h2>
			<input id="ramName" placeholder="Name" />
			<textarea id="ramDesc" placeholder="Description"></textarea>
			<button onclick="addRam()">Save Ram</button>
		</div>

		<div class="card">
			<h2>Add Bean Product</h2>
			<input id="beanName" placeholder="Name" />
			<textarea id="beanDesc" placeholder="Description"></textarea>
			<button onclick="addBean()">Save Bean</button>
		</div>

		<div class="card">
			<h2>Upload Video</h2>
			<select id="parentType">
				<option value="">Select type</option>
				<option value="ram">Ram</option>
				<option value="bean">Bean</option>
			</select>
			<input id="parentId" placeholder="Parent ID" />
			<input type="file" id="videoFile" accept="video/*" />
			<button onclick="uploadVideo()">Upload</button>
			<div id="uploadResult"></div>
		</div>

		<div class="card">
			<h2>Current Data</h2>
			<div class="grid">
				<div>
					<h3>Rams</h3>
					<pre id="rams"></pre>
				</div>
				<div>
					<h3>Beans</h3>
					<pre id="beans"></pre>
				</div>
			</div>
		</div>
	</div>

	<script>
		async function refresh() {
			const [rams, beans] = await Promise.all([
				fetch('/api/rams').then(r => r.json()),
				fetch('/api/beans').then(r => r.json())
			]);
			document.getElementById('rams').textContent = JSON.stringify(rams, null, 2);
			document.getElementById('beans').textContent = JSON.stringify(beans, null, 2);
		}

		async function addRam() {
			const name = document.getElementById('ramName').value.trim();
			const description = document.getElementById('ramDesc').value.trim();
			if (!name) return alert('Name required');
			await fetch('/api/admin/rams', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ name, description }) });
			document.getElementById('ramName').value = '';
			document.getElementById('ramDesc').value = '';
			refresh();
		}

		async function addBean() {
			const name = document.getElementById('beanName').value.trim();
			const description = document.getElementById('beanDesc').value.trim();
			if (!name) return alert('Name required');
			await fetch('/api/admin/beans', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ name, description }) });
			document.getElementById('beanName').value = '';
			document.getElementById('beanDesc').value = '';
			refresh();
		}

		function fileToBase64(file) {
			return new Promise((resolve, reject) => {
				const reader = new FileReader();
				reader.onload = () => resolve(reader.result.split(',')[1]);
				reader.onerror = reject;
				reader.readAsDataURL(file);
			});
		}

		async function uploadVideo() {
			const parentType = document.getElementById('parentType').value;
			const parentId = document.getElementById('parentId').value.trim();
			const file = document.getElementById('videoFile').files[0];
			if (!parentType || !parentId || !file) return alert('All fields required');
			const base64 = await fileToBase64(file);
			const resp = await fetch('/api/admin/upload', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ parentType, parentId, base64, filename: file.name }) });
			const data = await resp.json();
			document.getElementById('uploadResult').textContent = JSON.stringify(data, null, 2);
			refresh();
		}

		refresh();
	</script>
</body>
</html>