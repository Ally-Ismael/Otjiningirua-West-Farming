<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Reports - Otjiningirua West</title>
	<style>
		body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, sans-serif; margin: 20px; }
		.container { max-width: 1100px; margin: 0 auto; }
		.grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 12px; }
		.card { border: 1px solid #e5e7eb; border-radius: 8px; padding: 16px; }
		pre { white-space: pre-wrap; background: #f6f8fa; padding: 10px; border-radius: 6px; }
		.table { width: 100%; border-collapse: collapse; }
		th, td { border: 1px solid #e5e7eb; padding: 8px; text-align: left; font-size: 14px; }
		th { background: #f3f4f6; }
	</style>
</head>
<body>
	<div class="container">
		<h1>Business Analytics & Reports</h1>
		<div class="grid">
			<div class="card">
				<h3>Overview</h3>
				<pre id="overview"></pre>
			</div>
			<div class="card">
				<h3>Users by Type</h3>
				<pre id="users"></pre>
			</div>
			<div class="card">
				<h3>Orders by Status</h3>
				<pre id="orders"></pre>
			</div>
			<div class="card">
				<h3>Monthly Growth</h3>
				<table class="table" id="growthTable">
					<thead><tr><th>Month</th><th>Orders</th><th>Revenue</th></tr></thead>
					<tbody></tbody>
				</table>
			</div>
			<div class="card">
				<h3>Stock Summary</h3>
				<pre id="stock"></pre>
			</div>
			<div class="card">
				<h3>Recent Activity</h3>
				<pre id="logs"></pre>
			</div>
		</div>
	</div>

	<script>
		async function load() {
			const [report, summary, logs] = await Promise.all([
				fetch('/api/admin/reports/overview').then(r => r.json()),
				fetch('/api/admin/stock/summary').then(r => r.json()),
				fetch('/api/admin/logs').then(r => r.json())
			]);
			document.getElementById('overview').textContent = JSON.stringify({ users: report.users.total, orders: report.orders.total, revenue: report.orders.revenue, inquiries: report.inquiries.total }, null, 2);
			document.getElementById('users').textContent = JSON.stringify(report.users.byType, null, 2);
			document.getElementById('orders').textContent = JSON.stringify(report.orders.byStatus, null, 2);
			const tbody = document.querySelector('#growthTable tbody');
			tbody.innerHTML = (report.growth||[]).map(r => `<tr><td>${r.month}</td><td>${r.orders}</td><td>${r.revenue.toFixed ? r.revenue.toFixed(2) : r.revenue}</td></tr>`).join('');
			document.getElementById('stock').textContent = JSON.stringify(summary, null, 2);
			document.getElementById('logs').textContent = JSON.stringify(logs.slice(-10), null, 2);
		}
		load();
	</script>
</body>
</html>