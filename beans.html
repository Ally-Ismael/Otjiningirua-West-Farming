<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Beans - Otjiningirua West</title>
	<link rel="stylesheet" href="/css/styles.css">
	<style>
		.grid { display: grid; grid-template-columns: repeat(auto-fit,minmax(260px,1fr)); gap: 16px; }
		.card { background: #fff; border-radius: 12px; padding: 14px; box-shadow: 0 10px 30px rgba(0,0,0,0.08); border: 2px solid #eee; }
		.card h3 { margin: 8px 0; color: #2c5530; }
		.badge { display: inline-block; padding: 4px 10px; border-radius: 999px; font-size: 12px; font-weight: 600; }
		.badge.available { background: #e8f5e9; color: #2e7d32; }
		.badge.out_of_stock { background: #fff8e1; color: #ff8f00; }
		.badge.discontinued { background: #ffebee; color: #c62828; }
		.thumb { width: 100%; height: 180px; object-fit: cover; border-radius: 8px; background: #f3f4f6; }
		.actions { display:flex; gap:8px; margin-top: 10px; }
		.actions a, .actions button { flex:1; text-align:center; }
	</style>
</head>
<body>
	<header>
		<nav class="container">
			<div class="logo">üêë Otjiningirua West Farming</div>
			<ul class="nav-links">
				<li><a href="/">Home</a></li>
				<li><a href="/rams.html">Rams</a></li>
				<li><a href="/beans.html">Beans</a></li>
			</ul>
		</nav>
	</header>
	<main class="container" style="padding: 24px;">
		<h1 class="section-title" style="margin-top: 20px;">Beans</h1>
		<div id="grid" class="grid"></div>
	</main>
	<script>
		const CALL_NO = '+264811220667';
		const WA_NO = '264811220667';
		function firstMedia(b){
			const img = (b.media||[]).find(m=>m.type==='image');
			const vid = (b.media||[]).find(m=>m.type==='video');
			return img?.url || vid?.url || '';
		}
		function statusClass(s){ return s==='available'?'available':s==='out_of_stock'?'out_of_stock':'discontinued'; }
		async function load(){
			const beans = await fetch('/api/beans').then(r=>r.json());
			const el = document.getElementById('grid');
			el.innerHTML = beans.map(b=>{
				const media = firstMedia(b);
				return `
					<div class="card">
						${media? (media.endsWith('.mp4')||media.endsWith('.webm')?`<video class="thumb" src="${media}" muted loop></video>`:`<img class="thumb" src="${media}" alt="${b.name}">`):`<div class="thumb"></div>`}
						<h3>${b.name||'Beans'}</h3>
						<div class="badge ${statusClass(b.status)}">${(b.status||'available').toUpperCase()}</div>
						<div class="actions">
							<a class="cta-button" href="/bean.html?id=${encodeURIComponent(b.id)}">View</a>
							<a class="cta-button" href="tel:${CALL_NO}">Call</a>
							<a class="cta-button" target="_blank" href="https://wa.me/${WA_NO}?text=${encodeURIComponent('Hi, I am interested in '+(b.name||b.id)+' beans')}">WhatsApp</a>
						</div>
					</div>
				`;
			}).join('');
		}
		load();
	</script>
</body>
</html>

